###1.39###
PROMPT:
------------------------------------------------------------

Exercise 1.39.  A continued fraction representation of the tangent function was published in 1770 by the German mathematician J.H. Lambert:

x/(1+(x^2/3+(x^2/5+...)))

where x is in radians. Define a procedure (tan-cf x k) that computes an approximation to the tangent function based on Lambert's formula. K specifies the number of terms to compute, as in exercise 1.37.
------------------------------------------------------------

(define (cont-frac n d k)
  (define (cont-frac-iter i result)
    (if (= i 0)
	result
	(cont-frac-iter (- i 1)
			(/ (n i)
			   (+ (d i) result)))))
  (cont-frac-iter k 0))

(define (tan-cf x k)
  (cont-frac (lambda (i) (if (= i 1)
			     x
			     (square x)))
	     (lambda (i)
	       (let ((i (- i 1)))
		 (+ (* 2 i) 1)))
	     k))

(tan-cf 0 100)
;Value: 0
(tan-cf 1 100)
;Value: 7814594809655758299675164977161393451359073947708228293596488592500466083935897273484260733917100743274590556304622510910032959594503305887483876157957820820491611631410237029487586692275/10260838726957941164598884804808932020838088169874462428061547367033072002369459285733029886959605342770024815149594552964611310213784588100605477239258930324783038699674459441759853673751
(tan-cf .9 100)
;Value: .7162978701990245
(tan-cf -1 100)
;Value: -7814594809655758299675164977161393451359073947708228293596488592500466083935897273484260733917100743274590556304622510910032959594503305887483876157957820820491611631410237029487586692275/10260838726957941164598884804808932020838088169874462428061547367033072002369459285733029886959605342770024815149594552964611310213784588100605477239258930324783038699674459441759853673751
(tan-cf -1.1 100)
;Value: -.8004990217606297
